{
	"name": "Synapse Demo",
	"properties": {
		"content": {
			"query": "-- CREATE DATABASE DEMO_SYNAPSE\n\n-- VISUALIZE CSV FILE\n\n-- SELECT TOP 10 *\n-- FROM OPENROWSET(\n--     BULK\n--     'https://myazurefreetier.blob.core.windows.net/synapseanalytics/demoinput/imartdatafile.csv',\n--     FORMAT = 'csv',\n--     PARSER_VERSION = '2.0',\n--     FIRSTROW =2) AS ROWS\n\n-- BASIC TABLE CREATION\n-- CREATE OR ALTER VIEW imartview AS\n-- SELECT *\n-- FROM\n--     OPENROWSET(\n--         BULK 'https://myazurefreetier.blob.core.windows.net/synapseanalytics/demoinput/imartdatafile.csv',\n--         FORMAT = 'CSV',\n--         PARSER_VERSION='2.0',\n--         FIRSTROW = 2\n--     ) \n-- \tWITH (\n--     \t\t[Date] datetime2(3),\n--         \t[DateKey] decimal(38,0),\n--         \t[MonthKey] decimal(38,0)\n-- \t) AS ROWS;\n\n\n-- SELECT * FROM imartview\n\n\n\n\n\n\n-- Creating Schema and synapse Tutorial\n\n-- CREATE SCHEMA [imart_staging]\n\n\nCREATE TABLE [imart_staging].[SaleHeap]\n( \n    [TransactionId] [uniqueidentifier]  NOT NULL,\n    [CustomerId] [int]  NOT NULL,\n    [ProductId] [smallint]  NOT NULL,\n    [Quantity] [smallint]  NOT NULL,\n    [Price] [decimal](9,2)  NOT NULL,\n    [TotalAmount] [decimal](9,2)  NOT NULL,\n    [TransactionDate] [int]  NOT NULL,\n    [ProfitAmount] [decimal](9,2)  NOT NULL,\n    [Hour] [tinyint]  NOT NULL,\n    [Minute] [tinyint]  NOT NULL,\n    [StoreId] [smallint]  NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = ROUND_ROBIN ,\n    HEAP\n)\n\n\n\nCREATE TABLE [imart_staging].[Sale]\n(\n    [TransactionId] [uniqueidentifier]  NOT NULL,\n    [CustomerId] [int]  NOT NULL,\n    [ProductId] [smallint]  NOT NULL,\n    [Quantity] [smallint]  NOT NULL,\n    [Price] [decimal](9,2)  NOT NULL,\n    [TotalAmount] [decimal](9,2)  NOT NULL,\n    [TransactionDate] [int]  NOT NULL,\n    [ProfitAmount] [decimal](9,2)  NOT NULL,\n    [Hour] [tinyint]  NOT NULL,\n    [Minute] [tinyint]  NOT NULL,\n    [StoreId] [smallint]  NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ( [CustomerId] ),\n    CLUSTERED COLUMNSTORE INDEX\n    )\n\n\n\n\n-- Q4: CREATING EXTERNAL DATA SOURCE\nCREATE EXTERNAL DATA SOURCE imartds\nWITH (\n    TYPE = HADOOP,\n    LOCATION = 'abfss://synapseanalytics@myazurefreetier.dfs.core.windows.net'    \n);\n\n\n-- Q5: CREATING EXTERNAL FILE FORMAT\nCREATE EXTERNAL FILE FORMAT [ParquetFormat]\nWITH (\n    FORMAT_TYPE = PARQUET,\n    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.SnappyCodec'\n)\nGO\n\n-- IMPORTING DATA USING POLYBASE TECHNIQUE \n-- Q6:  Creating External schema\nCREATE SCHEMA [imart_external];\nGO\n\n\n-- DROP EXTERNAL TABLE [imart_external].Sales\n-- Q7: CREATING EXTERNAL TABLES USING THE DATA SOURCES AND FILE FORMAT\nCREATE EXTERNAL TABLE [imart_external].Sales\n    (\n        [TransactionId] [nvarchar](36)  NOT NULL,\n        [CustomerId] [int]  NOT NULL,\n        [ProductId] [smallint]  NOT NULL,\n        [Quantity] [smallint]  NOT NULL,\n        [Price] [decimal](9,2)  NOT NULL,\n        [TotalAmount] [decimal](9,2)  NOT NULL,\n        [TransactionDate] [int]  NOT NULL,\n        [ProfitAmount] [decimal](9,2)  NOT NULL,\n        [Hour] [tinyint]  NOT NULL,\n        [Minute] [tinyint]  NOT NULL,\n        [StoreId] [smallint]  NOT NULL\n    )\nWITH\n    (\n        LOCATION = '/demoinput',  \n        DATA_SOURCE = imartds,\n        FILE_FORMAT = [ParquetFormat]  \n    )  \nGO\n\n\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "demosynapse",
				"poolName": "demosynapse"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}